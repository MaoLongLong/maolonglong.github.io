<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>æ¯”ç‰¹å¸ç¬”è®° â€”â€” å“ˆå¸Œå‡½æ•° | æ¯›ç‘ç‘çš„åšå®¢</title><meta property="og:title" content="æ¯”ç‰¹å¸ç¬”è®° â€”â€” å“ˆå¸Œå‡½æ•° - æ¯›ç‘ç‘çš„åšå®¢"><meta property="og:type" content="article"><meta property="article:published_time" content="2021-06-19T22:46:59+08:00"><meta property="article:modified_time" content="2021-06-19T22:46:59+08:00"><meta name=Keywords content><meta name=description content="æ¯”ç‰¹å¸ç¬”è®° â€”â€” å“ˆå¸Œå‡½æ•°"><meta name=author content="æ¯›ç‘ç‘"><meta property="og:url" content="https://maolonglong.tech/post/blockchain/cryptographic-hash-functions/"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/style.css><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="https://hm.baidu.com/hm.js?b88ba8bad63352d4213631c01bab502f",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script><link href=https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css rel=stylesheet></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><a id=logo href=https://maolonglong.tech>æ¯›ç‘ç‘çš„åšå®¢</a><p class=description>åªæœ‰éå¸¸åŠªåŠ›ï¼Œæ‰èƒ½æ˜¾å¾—æ¯«ä¸è´¹åŠ›</p></div><div><nav id=nav-menu class=clearfix><a class=current href=https://maolonglong.tech>é¦–é¡µ</a>
<a href=https://maolonglong.tech/archives/ title=å½’æ¡£>å½’æ¡£</a>
<a href=https://maolonglong.tech/about/ title=å…³äº>å…³äº</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>æ¯”ç‰¹å¸ç¬”è®° â€”â€” å“ˆå¸Œå‡½æ•°</h1></header><date class="post-meta meta-date">2021å¹´6æœˆ19æ—¥</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=/categories/%E5%8C%BA%E5%9D%97%E9%93%BE>åŒºå—é“¾</a></span></div><div class=post-content><p>æ¯”ç‰¹å¸ä¸»è¦ç”¨åˆ°äº†å¯†ç å­¦ä¸­çš„ä¸¤ä¸ªåŠŸèƒ½ï¼š</p><ol><li>å“ˆå¸Œ</li><li>ç­¾å</li></ol><p>å¯†ç å­¦ä¸­ç”¨åˆ°çš„å“ˆå¸Œå‡½æ•°è¢«ç§°ä¸º <strong>cryptographic hash function</strong> ï¼Œå®ƒæœ‰ 3 ä¸ªé‡è¦çš„æ€§è´¨ï¼š</p><h2 id=collision-free-collision-resistance>collision free (collision resistance)</h2><blockquote><p>å·²çŸ¥å“ˆå¸Œå‡½æ•° $H$ï¼Œå¦‚æœå­˜åœ¨ $H(x)=H(y)$ åˆ™ç§°è¯¥ç°è±¡ä¸ºå“ˆå¸Œç¢°æ’</p></blockquote><p>æ³¨æ„è¿™ä¸ªæ€§è´¨ä¸æ˜¯ â€œæ— å“ˆå¸Œç¢°æ’â€ ï¼Œå› ä¸ºå“ˆå¸Œå‡½æ•°çš„è¾“å‡ºèŒƒå›´è¿œæ²¡æœ‰è¾“å…¥èŒƒå›´å¤§ï¼Œç¢°æ’æ˜¯ä¸å¯é¿å…çš„ã€‚æ‰€ä»¥è¯´æˆ collision resistanceï¼ˆæŠ—å“ˆå¸Œç¢°æ’ï¼‰æ›´åˆé€‚äº›ï¼Œå³æ— æ³•<strong>äººä¸º</strong>åˆ¶é€ å“ˆå¸Œç¢°æ’ã€‚</p><p>æ›¾ç»çš„ MD5 ä¹Ÿå·ç§° collision freeï¼Œä½†æ—©å·²ç»è¢«å¯†ç å­¦ä¸“å®¶ç ”ç©¶å‡ºäººä¸ºåˆ¶é€ å“ˆå¸Œç¢°æ’çš„æ–¹æ³•ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ <a href=https://zh.wikipedia.org/wiki/MD5#%E7%BC%BA%E9%99%B7>ç»´åŸºç™¾ç§‘</a></p><h2 id=hiding>hiding</h2><p>åŒºåˆ†æ¸…æ¥š<strong>å“ˆå¸Œ</strong>å’Œ<strong>åŠ å¯†</strong>çš„æ¦‚å¿µçš„è¯ï¼Œhiding å°±ä¸éš¾ç†è§£äº†ï¼ŒåŠ å¯†è‡ªç„¶æ˜¯æœ‰å¯¹åº”çš„è§£å¯†æ–¹æ³•ï¼Œä½†æ˜¯å“ˆå¸Œå‡½æ•°çš„è®¡ç®—è¿‡ç¨‹æ˜¯å•å‘çš„ï¼Œä¸å¯é€†çš„ã€‚hiding æ€§è´¨å‰ææ˜¯è¾“å…¥ç©ºé—´è¶³å¤Ÿå¤§ï¼Œåˆ†å¸ƒæ¯”è¾ƒå‡åŒ€ã€‚å¦‚æœä¸æ˜¯è¶³å¤Ÿå¤§ï¼Œä¸€èˆ¬åœ¨ x åé¢æ‹¼æ¥ä¸€ä¸ªéšæœºæ•°ï¼Œå¦‚ $H(x \parallel nonce)$ ã€‚</p><h2 id=puzzle-friendly>puzzle friendly</h2><p>puzzle friendly æ˜¯æŒ‡æŒ–çŸ¿è¿‡ç¨‹ä¸­æ²¡æœ‰æ·å¾„ï¼Œä¸ºäº†ä½¿è¾“å‡ºå€¼è½åœ¨æŒ‡å®šèŒƒå›´ï¼Œåªèƒ½ä¸€ä¸ªä¸€ä¸ªå»è¯•ã€‚æ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹è¿˜å¯ä»¥ä½œä¸ºå·¥ä½œé‡è¯æ˜ï¼ˆproof of workï¼‰ã€‚</p><p>æ¯”ç‰¹å¸æŒ–çŸ¿çš„è¿‡ç¨‹ä¸­å®é™…å°±æ˜¯æ‰¾ä¸€ä¸ªéšæœºæ•° nonceï¼Œnonce è·ŸåŒºå—çš„å—å¤´ï¼ˆblock headerï¼‰é‡Œçš„å…¶ä»–ä¿¡æ¯åˆä¸€èµ·ä½œä¸ºè¾“å…¥ï¼Œå¾—å‡ºçš„å“ˆå¸Œå€¼å‰ n ä½éƒ½ä¸º 0ã€‚</p><h3 id=secure-hash-algorithm-2>Secure Hash Algorithm 2</h3><blockquote><p>æ¯”ç‰¹å¸ä¸­ä½¿ç”¨çš„å“ˆå¸Œç®—æ³• <a href=https://zh.wikipedia.org/zh/SHA-2>SHA256</a> å°±æ»¡è¶³äº†ä»¥ä¸Š 3 ä¸ªæ€§è´¨</p></blockquote><p>ä»¥ä¸‹æ˜¯æ‘˜è‡ªç»´åŸºç™¾ç§‘ä¼ªä»£ç ï¼Œä¸ golang çš„ç®€å•å®ç°ï¼š</p><pre><code>Note: All variables are unsigned 32 bits and wrap modulo 2^32 when calculating

Initialize variables
(first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):
h0 := 0x6a09e667
h1 := 0xbb67ae85
h2 := 0x3c6ef372
h3 := 0xa54ff53a
h4 := 0x510e527f
h5 := 0x9b05688c
h6 := 0x1f83d9ab
h7 := 0x5be0cd19

Initialize table of round constants
(first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311):
k[0..63] :=
   0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
   0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
   0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
   0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
   0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
   0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
   0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
   0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2

Pre-processing:
append the bit '1' to the message
append k bits '0', where k is the minimum number &gt;= 0 such that the resulting message
    length (in bits) is congruent to 448(mod 512)
append length of message (before pre-processing), in bits, as 64-bit big-endian integer

Process the message in successive 512-bit chunks:
break message into 512-bit chunks
for each chunk
    break chunk into sixteen 32-bit big-endian words w[0..15]

    Extend the sixteen 32-bit words into sixty-four 32-bit words:
    for i from 16 to 63
        s0 := (w[i-15] rightrotate 7) xor (w[i-15] rightrotate 18) xor(w[i-15] rightshift 3)
        s1 := (w[i-2] rightrotate 17) xor (w[i-2] rightrotate 19) xor(w[i-2] rightshift 10)
        w[i] := w[i-16] + s0 + w[i-7] + s1

    Initialize hash value for this chunk:
    a := h0
    b := h1
    c := h2
    d := h3
    e := h4
    f := h5
    g := h6
    h := h7

    Main loop:
    for i from 0 to 63
        s0 := (a rightrotate 2) xor (a rightrotate 13) xor(a rightrotate 22)
        maj := (a and b) xor (a and c) xor(b and c)
        t2 := s0 + maj
        s1 := (e rightrotate 6) xor (e rightrotate 11) xor(e rightrotate 25)
        ch := (e and f) xor ((not e) and g)
        t1 := h + s1 + ch + k[i] + w[i]
        h := g
        g := f
        f := e
        e := d + t1
        d := c
        c := b
        b := a
        a := t1 + t2

    Add this chunk's hash to result so far:
    h0 := h0 + a
    h1 := h1 + b
    h2 := h2 + c
    h3 := h3 + d
    h4 := h4 + e
    h5 := h5 + f
    h6 := h6 + g
    h7 := h7 + h

Produce the final hash value (big-endian):
digest = hash = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7
</code></pre><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">98
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000;font-weight:700>func</span> <span style=color:#900;font-weight:700>sha256</span>(b []<span style=color:#458;font-weight:700>byte</span>) [<span style=color:#099>32</span>]<span style=color:#458;font-weight:700>byte</span> {

	h0 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0x6a09e667</span>)
	h1 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0xbb67ae85</span>)
	h2 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0x3c6ef372</span>)
	h3 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0xa54ff53a</span>)
	h4 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0x510e527f</span>)
	h5 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0x9b05688c</span>)
	h6 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0x1f83d9ab</span>)
	h7 <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>uint32</span>(<span style=color:#099>0x5be0cd19</span>)

	k <span style=color:#000;font-weight:700>:=</span> [<span style=color:#099>64</span>]<span style=color:#458;font-weight:700>uint32</span>{
		<span style=color:#099>0x428a2f98</span>, <span style=color:#099>0x71374491</span>, <span style=color:#099>0xb5c0fbcf</span>, <span style=color:#099>0xe9b5dba5</span>, <span style=color:#099>0x3956c25b</span>, <span style=color:#099>0x59f111f1</span>, <span style=color:#099>0x923f82a4</span>, <span style=color:#099>0xab1c5ed5</span>,
		<span style=color:#099>0xd807aa98</span>, <span style=color:#099>0x12835b01</span>, <span style=color:#099>0x243185be</span>, <span style=color:#099>0x550c7dc3</span>, <span style=color:#099>0x72be5d74</span>, <span style=color:#099>0x80deb1fe</span>, <span style=color:#099>0x9bdc06a7</span>, <span style=color:#099>0xc19bf174</span>,
		<span style=color:#099>0xe49b69c1</span>, <span style=color:#099>0xefbe4786</span>, <span style=color:#099>0x0fc19dc6</span>, <span style=color:#099>0x240ca1cc</span>, <span style=color:#099>0x2de92c6f</span>, <span style=color:#099>0x4a7484aa</span>, <span style=color:#099>0x5cb0a9dc</span>, <span style=color:#099>0x76f988da</span>,
		<span style=color:#099>0x983e5152</span>, <span style=color:#099>0xa831c66d</span>, <span style=color:#099>0xb00327c8</span>, <span style=color:#099>0xbf597fc7</span>, <span style=color:#099>0xc6e00bf3</span>, <span style=color:#099>0xd5a79147</span>, <span style=color:#099>0x06ca6351</span>, <span style=color:#099>0x14292967</span>,
		<span style=color:#099>0x27b70a85</span>, <span style=color:#099>0x2e1b2138</span>, <span style=color:#099>0x4d2c6dfc</span>, <span style=color:#099>0x53380d13</span>, <span style=color:#099>0x650a7354</span>, <span style=color:#099>0x766a0abb</span>, <span style=color:#099>0x81c2c92e</span>, <span style=color:#099>0x92722c85</span>,
		<span style=color:#099>0xa2bfe8a1</span>, <span style=color:#099>0xa81a664b</span>, <span style=color:#099>0xc24b8b70</span>, <span style=color:#099>0xc76c51a3</span>, <span style=color:#099>0xd192e819</span>, <span style=color:#099>0xd6990624</span>, <span style=color:#099>0xf40e3585</span>, <span style=color:#099>0x106aa070</span>,
		<span style=color:#099>0x19a4c116</span>, <span style=color:#099>0x1e376c08</span>, <span style=color:#099>0x2748774c</span>, <span style=color:#099>0x34b0bcb5</span>, <span style=color:#099>0x391c0cb3</span>, <span style=color:#099>0x4ed8aa4a</span>, <span style=color:#099>0x5b9cca4f</span>, <span style=color:#099>0x682e6ff3</span>,
		<span style=color:#099>0x748f82ee</span>, <span style=color:#099>0x78a5636f</span>, <span style=color:#099>0x84c87814</span>, <span style=color:#099>0x8cc70208</span>, <span style=color:#099>0x90befffa</span>, <span style=color:#099>0xa4506ceb</span>, <span style=color:#099>0xbef9a3f7</span>, <span style=color:#099>0xc67178f2</span>}

	padded <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>append</span>(b, <span style=color:#099>0x80</span>)
	<span style=color:#000;font-weight:700>if</span> <span style=color:#0086b3>len</span>(padded)<span style=color:#000;font-weight:700>%</span><span style=color:#099>64</span> &lt; <span style=color:#099>56</span> {
		padded = <span style=color:#0086b3>append</span>(padded, <span style=color:#0086b3>make</span>([]<span style=color:#458;font-weight:700>byte</span>, <span style=color:#099>56</span><span style=color:#000;font-weight:700>-</span><span style=color:#0086b3>len</span>(padded)<span style=color:#000;font-weight:700>%</span><span style=color:#099>64</span>)<span style=color:#000;font-weight:700>...</span>)
	} <span style=color:#000;font-weight:700>else</span> {
		padded = <span style=color:#0086b3>append</span>(padded, <span style=color:#0086b3>make</span>([]<span style=color:#458;font-weight:700>byte</span>, <span style=color:#099>56</span><span style=color:#000;font-weight:700>+</span><span style=color:#099>64</span><span style=color:#000;font-weight:700>-</span><span style=color:#0086b3>len</span>(padded)<span style=color:#000;font-weight:700>%</span><span style=color:#099>64</span>)<span style=color:#000;font-weight:700>...</span>)
	}

	<span style=color:#000;font-weight:700>var</span> l [<span style=color:#099>8</span>]<span style=color:#458;font-weight:700>byte</span>
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint64</span>(l[:], <span style=color:#0086b3>uint64</span>(<span style=color:#0086b3>len</span>(b)<span style=color:#000;font-weight:700>*</span><span style=color:#099>8</span>))
	padded = <span style=color:#0086b3>append</span>(padded, l[:]<span style=color:#000;font-weight:700>...</span>)

	n <span style=color:#000;font-weight:700>:=</span> <span style=color:#0086b3>len</span>(padded) <span style=color:#000;font-weight:700>/</span> <span style=color:#099>64</span>
	<span style=color:#000;font-weight:700>for</span> t <span style=color:#000;font-weight:700>:=</span> <span style=color:#099>0</span>; t &lt; n; t<span style=color:#000;font-weight:700>++</span> {
		chunk <span style=color:#000;font-weight:700>:=</span> padded[t<span style=color:#000;font-weight:700>*</span><span style=color:#099>64</span> : t<span style=color:#000;font-weight:700>*</span><span style=color:#099>64</span><span style=color:#000;font-weight:700>+</span><span style=color:#099>64</span>]

		<span style=color:#000;font-weight:700>var</span> w [<span style=color:#099>64</span>]<span style=color:#458;font-weight:700>uint32</span>
		<span style=color:#000;font-weight:700>for</span> i <span style=color:#000;font-weight:700>:=</span> <span style=color:#099>0</span>; i &lt; <span style=color:#099>16</span>; i<span style=color:#000;font-weight:700>++</span> {
			w[i] = binary.BigEndian.<span style=color:#900;font-weight:700>Uint32</span>(chunk[i<span style=color:#000;font-weight:700>*</span><span style=color:#099>4</span> : i<span style=color:#000;font-weight:700>*</span><span style=color:#099>4</span><span style=color:#000;font-weight:700>+</span><span style=color:#099>4</span>])
		}

		<span style=color:#000;font-weight:700>for</span> i <span style=color:#000;font-weight:700>:=</span> <span style=color:#099>16</span>; i &lt; <span style=color:#099>64</span>; i<span style=color:#000;font-weight:700>++</span> {
			s0 <span style=color:#000;font-weight:700>:=</span> <span style=color:#900;font-weight:700>rightRotate</span>(w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>15</span>], <span style=color:#099>7</span>) ^ <span style=color:#900;font-weight:700>rightRotate</span>(w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>15</span>], <span style=color:#099>18</span>) ^ (w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>15</span>] <span style=color:#000;font-weight:700>&gt;&gt;</span> <span style=color:#099>3</span>)
			s1 <span style=color:#000;font-weight:700>:=</span> <span style=color:#900;font-weight:700>rightRotate</span>(w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>2</span>], <span style=color:#099>17</span>) ^ <span style=color:#900;font-weight:700>rightRotate</span>(w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>2</span>], <span style=color:#099>19</span>) ^ (w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>2</span>] <span style=color:#000;font-weight:700>&gt;&gt;</span> <span style=color:#099>10</span>)
			w[i] = w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>16</span>] <span style=color:#000;font-weight:700>+</span> s0 <span style=color:#000;font-weight:700>+</span> w[i<span style=color:#000;font-weight:700>-</span><span style=color:#099>7</span>] <span style=color:#000;font-weight:700>+</span> s1
		}

		a <span style=color:#000;font-weight:700>:=</span> h0
		b <span style=color:#000;font-weight:700>:=</span> h1
		c <span style=color:#000;font-weight:700>:=</span> h2
		d <span style=color:#000;font-weight:700>:=</span> h3
		e <span style=color:#000;font-weight:700>:=</span> h4
		f <span style=color:#000;font-weight:700>:=</span> h5
		g <span style=color:#000;font-weight:700>:=</span> h6
		h <span style=color:#000;font-weight:700>:=</span> h7

		<span style=color:#000;font-weight:700>for</span> i <span style=color:#000;font-weight:700>:=</span> <span style=color:#099>0</span>; i &lt; <span style=color:#099>64</span>; i<span style=color:#000;font-weight:700>++</span> {
			s0 <span style=color:#000;font-weight:700>:=</span> <span style=color:#900;font-weight:700>rightRotate</span>(a, <span style=color:#099>2</span>) ^ <span style=color:#900;font-weight:700>rightRotate</span>(a, <span style=color:#099>13</span>) ^ <span style=color:#900;font-weight:700>rightRotate</span>(a, <span style=color:#099>22</span>)
			maj <span style=color:#000;font-weight:700>:=</span> (a <span style=color:#000;font-weight:700>&amp;</span> b) ^ (a <span style=color:#000;font-weight:700>&amp;</span> c) ^ (b <span style=color:#000;font-weight:700>&amp;</span> c)
			t2 <span style=color:#000;font-weight:700>:=</span> s0 <span style=color:#000;font-weight:700>+</span> maj
			s1 <span style=color:#000;font-weight:700>:=</span> <span style=color:#900;font-weight:700>rightRotate</span>(e, <span style=color:#099>6</span>) ^ <span style=color:#900;font-weight:700>rightRotate</span>(e, <span style=color:#099>11</span>) ^ <span style=color:#900;font-weight:700>rightRotate</span>(e, <span style=color:#099>25</span>)
			ch <span style=color:#000;font-weight:700>:=</span> (e <span style=color:#000;font-weight:700>&amp;</span> f) ^ ((^e) <span style=color:#000;font-weight:700>&amp;</span> g)
			t1 <span style=color:#000;font-weight:700>:=</span> h <span style=color:#000;font-weight:700>+</span> s1 <span style=color:#000;font-weight:700>+</span> ch <span style=color:#000;font-weight:700>+</span> k[i] <span style=color:#000;font-weight:700>+</span> w[i]
			h = g
			g = f
			f = e
			e = d <span style=color:#000;font-weight:700>+</span> t1
			d = c
			c = b
			b = a
			a = t1 <span style=color:#000;font-weight:700>+</span> t2
		}

		h0 <span style=color:#000;font-weight:700>+=</span> a
		h1 <span style=color:#000;font-weight:700>+=</span> b
		h2 <span style=color:#000;font-weight:700>+=</span> c
		h3 <span style=color:#000;font-weight:700>+=</span> d
		h4 <span style=color:#000;font-weight:700>+=</span> e
		h5 <span style=color:#000;font-weight:700>+=</span> f
		h6 <span style=color:#000;font-weight:700>+=</span> g
		h7 <span style=color:#000;font-weight:700>+=</span> h
	}

	<span style=color:#000;font-weight:700>var</span> digest [<span style=color:#099>32</span>]<span style=color:#458;font-weight:700>byte</span>
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>0</span>:], h0)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>4</span>:], h1)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>8</span>:], h2)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>12</span>:], h3)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>16</span>:], h4)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>20</span>:], h5)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>24</span>:], h6)
	binary.BigEndian.<span style=color:#900;font-weight:700>PutUint32</span>(digest[<span style=color:#099>28</span>:], h7)
	<span style=color:#000;font-weight:700>return</span> digest
}

<span style=color:#000;font-weight:700>func</span> <span style=color:#900;font-weight:700>rightRotate</span>(x, n <span style=color:#458;font-weight:700>uint32</span>) <span style=color:#458;font-weight:700>uint32</span> {
	<span style=color:#000;font-weight:700>return</span> (x <span style=color:#000;font-weight:700>&gt;&gt;</span> n) | (x <span style=color:#000;font-weight:700>&lt;&lt;</span> (<span style=color:#099>32</span> <span style=color:#000;font-weight:700>-</span> n))
}
</code></pre></td></tr></table></div></div></div><div class=post-archive><h2>See Also</h2><ul class=listing><li><a href=/post/golang/unsafe/>Unsafe Go</a></li><li><a href=/about/>å…³äº</a></li><li><a href=/post/%E7%94%9F%E6%B4%BB/%E6%96%B0%E7%9A%84%E5%BC%80%E5%A7%8B/>æ–°çš„å¼€å§‹</a></li><li><a href=/post/java/reentrant-lock/>ã€Java å¹¶å‘ã€‘é‡å…¥é”ï¼ˆReentrantLockï¼‰</a></li><li><a href=/post/java/volatile/>ã€Java å¹¶å‘ã€‘volatile å…³é”®å­—åŸºæœ¬ç†è§£ä¸ä½¿ç”¨</a></li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a href=/tags/Bitcoin>Bitcoin</a></li><li><a href=/tags/SHA256>SHA256</a></li></ul></div></article><div class="post bg-white"><script src=https://utteranc.es/client.js repo=MaoLongLong/maolonglong.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><footer id=footer><div>&copy; 2021 <a href=https://maolonglong.tech>æ¯›ç‘ç‘çš„åšå®¢ By æ¯›ç‘ç‘</a></div><br><div><div class=github-badge><a href=https://gohugo.io/ target=_black rel=nofollow><span class=badge-subject>Powered by</span><span class="badge-value bg-blue">Hugo</span></a></div><div class=github-badge><a href=https://www.flysnow.org/ target=_black><span class=badge-subject>Design by</span><span class="badge-value bg-brightgreen">é£é›ªæ— æƒ…</span></a></div><div class=github-badge><a href=https://github.com/flysnow-org/maupassant-hugo target=_black><span class=badge-subject>Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a></div></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:!0}}</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script src=https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js></script><a id=rocket href=#top></a><script type=text/javascript src="/js/totop.js?v=0.0.0" async></script></div><div id=secondary><section class=widget><form id=search action=https://maolonglong.tech/search/ method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://maolonglong.tech>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>æœ€è¿‘æ–‡ç« </h3><ul class=widget-list><li><a href=https://maolonglong.tech/post/golang/goroutine-lifecycles/ title="goroutine ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†">goroutine ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†</a></li><li><a href=https://maolonglong.tech/post/golang/functional-options/ title="Go å‡½æ•°é€‰é¡¹æ¨¡å¼ï¼ˆFunctional Optionsï¼‰">Go å‡½æ•°é€‰é¡¹æ¨¡å¼ï¼ˆFunctional Optionsï¼‰</a></li><li><a href=https://maolonglong.tech/post/golang/bytebufferpool/ title="é«˜æ€§èƒ½å­—èŠ‚æ± è®¾è®¡ | bytebufferpool æºç åˆ†æ">é«˜æ€§èƒ½å­—èŠ‚æ± è®¾è®¡ | bytebufferpool æºç åˆ†æ</a></li><li><a href=https://maolonglong.tech/post/golang/queue/ title=æ— é”é˜Ÿåˆ—çš„ç®€å•å®ç°>æ— é”é˜Ÿåˆ—çš„ç®€å•å®ç°</a></li><li><a href=https://maolonglong.tech/post/blockchain/cryptographic-hash-functions/ title="æ¯”ç‰¹å¸ç¬”è®° â€”â€” å“ˆå¸Œå‡½æ•°">æ¯”ç‰¹å¸ç¬”è®° â€”â€” å“ˆå¸Œå‡½æ•°</a></li><li><a href=https://maolonglong.tech/post/golang/unsafe/ title="Unsafe Go">Unsafe Go</a></li><li><a href=https://maolonglong.tech/post/%E7%94%9F%E6%B4%BB/%E6%96%B0%E7%9A%84%E5%BC%80%E5%A7%8B/ title=æ–°çš„å¼€å§‹>æ–°çš„å¼€å§‹</a></li><li><a href=https://maolonglong.tech/post/java/reentrant-lock/ title="ã€Java å¹¶å‘ã€‘é‡å…¥é”ï¼ˆReentrantLockï¼‰">ã€Java å¹¶å‘ã€‘é‡å…¥é”ï¼ˆReentrantLockï¼‰</a></li><li><a href=https://maolonglong.tech/post/java/volatile/ title="ã€Java å¹¶å‘ã€‘volatile å…³é”®å­—åŸºæœ¬ç†è§£ä¸ä½¿ç”¨">ã€Java å¹¶å‘ã€‘volatile å…³é”®å­—åŸºæœ¬ç†è§£ä¸ä½¿ç”¨</a></li></ul></section><section class=widget><h3 class=widget-title style=color:red>ç¦åˆ©æ´¾é€</h3><ul class=widget-list><li><a href="https://pages.aliyundrive.com/mobile-page/web/beinvited.html?code=0d9686e" title="æˆ‘åœ¨ä½¿ç”¨ä¸é™é€Ÿã€Œé˜¿é‡Œäº‘ç›˜ã€ï¼Œèµ é€ä½  500GB å¿«æ¥è¯•è¯•å§ ğŸ‰" target=_blank style=color:red><img src=/aliyundrive.png></a></li></ul></section><section class=widget><h3 class=widget-title><a href=/categories/>åˆ†ç±»</a></h3><ul class=widget-list><li><a href=https://maolonglong.tech/categories/Golang/>Golang (5)</a></li><li><a href=https://maolonglong.tech/categories/Java/>Java (2)</a></li><li><a href=https://maolonglong.tech/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/>åŒºå—é“¾ (1)</a></li><li><a href=https://maolonglong.tech/categories/%E7%94%9F%E6%B4%BB/>ç”Ÿæ´» (1)</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/tags/>æ ‡ç­¾</a></h3><div class=tagcloud><a href=https://maolonglong.tech/tags/Bitcoin/>Bitcoin</a>
<a href=https://maolonglong.tech/tags/CAS/>CAS</a>
<a href=https://maolonglong.tech/tags/Pool/>Pool</a>
<a href=https://maolonglong.tech/tags/ReentrantLock/>ReentrantLock</a>
<a href=https://maolonglong.tech/tags/SHA256/>SHA256</a>
<a href=https://maolonglong.tech/tags/goroutine/>goroutine</a>
<a href=https://maolonglong.tech/tags/unsafe/>unsafe</a>
<a href=https://maolonglong.tech/tags/volatile/>volatile</a>
<a href=https://maolonglong.tech/tags/%E5%AE%9E%E4%B9%A0/>å®ä¹ </a>
<a href=https://maolonglong.tech/tags/%E5%B9%B6%E5%8F%91/>å¹¶å‘</a>
<a href=https://maolonglong.tech/tags/%E7%AB%9E%E8%B5%9B/>ç«èµ›</a>
<a href=https://maolonglong.tech/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>è®¾è®¡æ¨¡å¼</a></div></section><section class=widget><h3 class=widget-title>å…¶å®ƒ</h3><ul class=widget-list><li><a href=https://maolonglong.tech/index.xml>æ–‡ç«  RSS</a></li></ul></section></div></div></div></div></body></html>